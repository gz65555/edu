var AssetAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?n(s):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var Api=function(){function t(){}var e=(__define,t);e.prototype;return t.Init=function(e,i){t.GlobalRes=new GlobalRes,t.StageUtil=new StageUtil(e),t.ModuleManager=new ModuleManager,t.DateUtil=new DateUtil,t.ResourceUtil=new ResourceUtil,t.Layers=new Layers(e),t.ViewManager=new ViewManager,t.TimerManager=new TimerManager,t.ArrayUtil=new ArrayUtil,t.TipsManager=new TipsManager,t.Dialogue=new Dialogue,t.MathUtils=new MathUtils,t.URLLoaderPool=new URLLoaderPool,t.TextFlowMaker=new TextFlowMaker,t.Log=new Log,t.NumberFormat=new NumberFormat,t.DragManager=new DragManager,t.Gesture=new Gesture,t.Keyboard=new Keyboard},t}();egret.registerClass(Api,"Api");var EventCenter=function(){function t(){}var e=(__define,t);e.prototype;return t.addEventListener=function(t,e,i){this._eventDic[t]||(this._eventDic[t]=[]),this.hasEventListener(t,e,i)||this._eventDic[t].push({"this":i,fun:e})},t.hasEventListener=function(t,e,i){if(!this._eventDic[t])return!1;for(var n;n<this._eventDic[t].length;n++)if(this._eventDic[t][n].fun==e&&this._eventDic[t][n]["this"]==i)return!0;return!1},t.removeEventListener=function(t,e,i){var n=this;this._eventDic[t]&&this._eventDic[t].forEach(function(s,r){return s.fun==e&&s["this"]==i?void n._eventDic[t].splice(r,1):void 0})},t.getEventIndex=function(t,e,i){if(!this._eventDic[t])return-1;for(var n;n<this._eventDic[t].length;n++)if(this._eventDic[t][n].fun==e&&this._eventDic[t][n]["this"]==i)return n;return-1},t.dispatchEvent=function(t){if(this._eventDic[t.type]){var e;for(var i in this._eventDic[t.type])e=this._eventDic[t.type][i],e.fun.call(e["this"],t)}},t.dispatchWith=function(e,i){t.dispatchEvent(new GameEvent(e,i))},t._eventDic={},t}();egret.registerClass(EventCenter,"EventCenter");var GameEvent=function(t){function e(e,i){t.call(this,e),this.eventBody=i}__extends(e,t);var i=(__define,e);i.prototype;return e.GAME_EVENT_GAMEOVER="game_over",e.GAME_EVENT_GAMESTART="game_start",e.GAME_EVENT_GAMERESTART="game_restart",e.GAME_EVENT_SHARE="game_share",e.SERVER_CONNECTED="server_connected",e.SERVER_CONNECT_CLOSE="server_connect_close",e.DRAG_BEGIN="drag_begin",e.DRAG_MOVE="drag_move",e.DRAG_END="drag_end",e}(egret.Event);egret.registerClass(GameEvent,"GameEvent");var JsonpManager=function(){function t(){}var e=(__define,t);e.prototype;return t.process=function(e,i,n){t.completeCall["call_"+t._regID]=function(){i.bind(n)(),t._callbackCount++,t._callbackCount==t._regID&&(t.completeCall={})},t.startLoader(e,t._regID++)},t.startLoader=function(t,e){var i=document.createElement("script");i.src=t+"JsonpManager.completeCall.call_"+e,document.body.appendChild(i);var n=this.getXHR();n.open("HEAD","index.html",!0),n.send()},t.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},t._regID=0,t._callbackCount=0,t.completeCall={},t}();egret.registerClass(JsonpManager,"JsonpManager");var ButtonState=function(){function t(){}var e=(__define,t);e.prototype;return t.UP="up",t.DOWN="down",t.DISABLE="disable",t}();egret.registerClass(ButtonState,"ButtonState");var Lang=function(){function t(){}var e=(__define,t);e.prototype;return t.LANG_CN="cn",t.LANG_EN="en",t.LANG_TW="tw",t}();egret.registerClass(Lang,"Lang");var DragManager=function(){function t(){this._dragItems=new Dict,this._dragAccept={},this._savedItemProp={},this.initStageEvent()}var e=(__define,t),i=e.prototype;return i.initStageEvent=function(){Api.StageUtil.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),Api.StageUtil.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),Api.StageUtil.stage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)},i.initDragItemEvent=function(t){t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)},i.removeDragItemEvent=function(t){t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)},i.initAcceptDragEvent=function(t){t.addEventListener(egret.TouchEvent.TOUCH_END,this.onAcceptDrag,this)},i.removeAcceptDragEvent=function(t){t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onAcceptDrag,this)},i.regAcceptDrag=function(t,e){this._dragAccept[t.hashCode]=e,this.initAcceptDragEvent(t)},i.removeAcceptDrag=function(t){delete this._dragAccept[t.hashCode],this.removeAcceptDragEvent(t)},i.regDragItem=function(t){this._dragItems[t.hashCode]=t,this.initDragItemEvent(t)},i.removeDragItem=function(t){this.removeDragItemEvent(t),delete this._dragItems[t.hashCode]},i.onAcceptDrag=function(t){this._currDragItem&&this._dragAccept.hasOwnProperty(t.currentTarget.hashCode)&&(!this._dragAccept[t.currentTarget.hashCode]||this._currDragItem instanceof this._dragAccept[t.currentTarget.hashCode])&&t.currentTarget.onDragIn(this._currDragItem)},i.onTouchBegin=function(t){this._dragItems[t.currentTarget.hashCode]&&(this._needCheck=!0,this._startPos=new egret.Point(t.stageX,t.stageY),this._currDragItem=this._dragItems[t.currentTarget.hashCode])},i.onTouchMove=function(t){this._needCheck&&(this._isDragMove?(this._currDragItem.onDragMove(t),this._currDragItem.x=this._savedItemProp.globalX+t.stageX-this._startPos.x,this._currDragItem.y=this._savedItemProp.globalY+t.stageY-this._startPos.y):(Math.abs(t.stageX-this._startPos.x)>10||Math.abs(t.stageY-this._startPos.y)>10)&&(this._isDragMove=!0,this._currDragItem.onDragBegin(t),this._currDragItem.touchEnabled=!1,this._currDragItem.touchChildren=!1,this.saveItemProp()))},i.resumeProp=function(){this._currDragItem.x=this._savedItemProp.x,this._currDragItem.y=this._savedItemProp.y,this._savedItemProp.parent.addChildAt(this._currDragItem,this._savedItemProp.childIndex)},i.saveItemProp=function(){this._savedItemProp.x=this._currDragItem.x,this._savedItemProp.y=this._currDragItem.y;var t=this._currDragItem.localToGlobal(0,0);this._savedItemProp.globalX=t.x,this._savedItemProp.globalY=t.y,this._savedItemProp.childIndex=this._currDragItem.parent.getChildIndex(this._currDragItem),this._savedItemProp.parent=this._currDragItem.parent,this._currDragItem.x=t.x,this._currDragItem.y=t.y,Api.StageUtil.stage.addChild(this._currDragItem)},i.onTouchEnd=function(t){this._needCheck&&(this._isDragMove&&(this._currDragItem.onDragEnd(t),this.resumeProp()),this._needCheck=!1,this._isDragMove=!1,this._currDragItem.touchEnabled=!0,this._currDragItem=null)},t}();egret.registerClass(DragManager,"DragManager");var Gesture=function(){function t(){this._longTouchTimer=new Dict,this._longTouchCallback=new Dict,this._doubleTouchCallback=new Dict,this._doubleTouchTimer=new Dict}var e=(__define,t),i=e.prototype;return i.addDoubleTouchCallback=function(t,e,i){t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._doubleTouchCallback[t.hashCode]||(this._doubleTouchCallback[t.hashCode]=[]),this._doubleTouchCallback[t.hashCode].push({callback:e,callobj:i})},i.addLongTouchCallback=function(t,e,i){t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchOut,this),this._longTouchCallback[t.hashCode]||(this._longTouchCallback[t.hashCode]=[]),this._longTouchCallback[t.hashCode].push({callback:e,callobj:i})},i.removeLongTouchCallback=function(t,e,i){if(this._longTouchCallback[t.hashCode])for(var n=this._longTouchCallback[t.hashCode].length-1;n>=0;n--)this._longTouchCallback[t.hashCode][n].callback==e&&this._longTouchCallback[t.hashCode][n].callobj==i&&this._longTouchCallback[t.hashCode].splice(n,1)},i.onTouchBegin=function(t){this._longTouchTimer[t.currentTarget.hashCode]&&(this._touchBeginX=t.stageX,this._touchBeginY=t.stageY,Api.TimerManager.remove(this._longTouchTimer[t.currentTarget.hashCode])),this._longTouchTimer[t.currentTarget.hashCode]=Api.TimerManager.setTimeout(this.onTimeOut,this,300,t.currentTarget)},i.onTouchMove=function(t){(Math.abs(this._touchBeginX-t.stageX)>6||Math.abs(this._touchBeginY-t.stageY)>6)&&this.removeTimer(t.currentTarget)},i.onTimeOut=function(t){this.removeTimer(t),this.callTarget(t)},i.callTarget=function(t){this._longTouchCallback[t.hashCode]&&this._longTouchCallback[t.hashCode].map(function(e){e.callback.call(e.callobj,t)})},i.onTouchOut=function(t){this.removeTimer(t.currentTarget)},i.onTouchEnd=function(t){this.removeTimer(t.currentTarget)},i.removeTimer=function(t){this._longTouchTimer[t.hashCode]&&Api.TimerManager.remove(this._longTouchTimer[t.hashCode])},i.onTouchTap=function(t){var e=egret.getTimer();this._doubleTouchTimer[t.currentTarget.hashCode]&&e-this._doubleTouchTimer[t.currentTarget.hashCode]<400&&this.callDoubleTouch(t.currentTarget),this._doubleTouchTimer[t.currentTarget.hashCode]=e},i.callDoubleTouch=function(t){this._doubleTouchCallback[t.hashCode]&&this._doubleTouchCallback[t.hashCode].map(function(e){e.callback.call(e.callobj,t)})},t}();egret.registerClass(Gesture,"Gesture");var Keyboard=function(){function t(){this._keyDownEvents=new Dict,this._keyUpEvents=new Dict,this.initEvent()}var e=(__define,t),i=e.prototype;return i.initEvent=function(){egret.Capabilities.runtimeType==egret.MainContext.RUNTIME_HTML5&&(document.addEventListener("keyup",function(e){EventCenter.dispatchEvent(new GameEvent(t.KeyUpEvent+"_"+e.keyCode))}),document.addEventListener("keydown",function(e){EventCenter.dispatchEvent(new GameEvent(t.KeyDownEvent+"_"+e.keyCode))}))},i.addKeyUpListener=function(e,i,n){EventCenter.addEventListener(t.KeyUpEvent+"_"+e,i,n)},i.removeKeyUpListener=function(t,e,i){},i.addKeyDownListener=function(e,i,n){EventCenter.addEventListener(t.KeyDownEvent+"_"+e,i,n)},i.removeKeyDownListener=function(t,e,i){},i.onKeyUp=function(t){},t.KeyUpEvent="keyupevent",t.KeyDownEvent="keydownevent",t.KEY_BACKSPACE=8,t.KEY_TAB=9,t.KEY_CLEAR=12,t.KEY_ENTER=13,t.KEY_SHIFT_LEFT=16,t.KEY_CONTROL_LEFT=17,t.KEY_ALT_LEFT=18,t.KEY_ESC=27,t.KEY_SPACE=32,t.KEY_LEFT=37,t.KEY_UP=38,t.KEY_RIGHT=39,t.KEY_DOWN=40,t.KEY_DELETE=46,t.KEY_0=48,t.KEY_1=49,t.KEY_2=50,t.KEY_3=51,t.KEY_4=52,t.KEY_5=53,t.KEY_6=54,t.KEY_7=55,t.KEY_8=56,t.KEY_9=57,t.KEY_A=65,t.KEY_B=66,t.KEY_C=67,t.KEY_D=68,t.KEY_E=69,t.KEY_F=70,t.KEY_G=71,t.KEY_H=72,t.KEY_I=73,t.KEY_J=74,t.KEY_K=75,t.KEY_L=76,t.KEY_M=77,t.KEY_N=78,t.KEY_O=79,t.KEY_P=80,t.KEY_Q=81,t.KEY_R=82,t.KEY_S=83,t.KEY_T=84,t.KEY_U=85,t.KEY_V=86,t.KEY_W=87,t.KEY_X=88,t.KEY_Y=89,t.KEY_Z=90,t}();egret.registerClass(Keyboard,"Keyboard");var Button=function(t){function e(){t.call(this),this._enabled=!0,this.initEvent(),this.skinName="resource/skins/component/SimpleButtonSkin.exml"}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.initEvent=function(){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)},s.createChildren=function(){t.prototype.createChildren.call(this),this._isInited=!0,this._dis&&this.setLabelDisplay(this._dis)},i(s,"buttonWidth",function(){return this._btnWidth},function(t){this._btnWidth=t,this.width=t}),s.onTouchEnd=function(){this._enabled&&(this._touchBegin&&this.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP)),this._touchBegin=!1,this.currentState=ButtonState.UP)},s.onTouchBegin=function(){this._enabled&&(this._touchBegin=!0,this.currentState=ButtonState.DOWN)},i(s,"enabled",function(){return this._enabled},function(t){this._enabled=t,t?this.currentState=ButtonState.UP:this.currentState=ButtonState.DISABLE}),s.setBtnSkin=function(t,e,i){this.up.source=t,e?this.down.source=e:this.down.source=t,i?this.disable.source=i:this.disable.source=t},s.setLabelDisplay=function(t){return this._isInited?void("string"==typeof t?this.labelDisplay.text=t:(this._labelDis=t,this.addChild(this._labelDis),this.labelDisplay.visible=!1)):void(this._dis=t)},e}(eui.Component);egret.registerClass(Button,"Button");var CCDisplayObjectContainer=function(t){function e(){t.call(this),this._childIndex={}}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addChild=function(e){return this._childIndex[this.getNewMaxIndex()]=e,t.prototype.addChild.call(this,e)},n.addChildAt=function(t,e){return this.validateChildrenIndex(e),this._childIndex[e]=t,this.addChild(t),this.sortChildren(e),t},n.removeChild=function(e){return this.deleteChild(e),t.prototype.removeChild.call(this,e)},n.getNewMaxIndex=function(){var t=Object.keys(this._childIndex);return t.sort(),parseFloat(t[t.length-1])+1},n.deleteChild=function(t){for(var e=Object.keys(this._childIndex),i=0,n=e.length;n>i;i++)if(this._childIndex[e[i]]==t){delete this._childIndex[e[i]];break}},n.validateChildrenIndex=function(t){for(var e=t;this._childIndex[e];)if(e-=.01,void 0==this._childIndex[e]){for(var i=e;t>i;i+=.01)this._childIndex[i]=this._childIndex[i+.01];break}},n.sortChildren=function(t){var e=Object.keys(this._childIndex);e.sort();for(var i=0,n=e.length;n>i;i++)t>i||this.addChild(this._childIndex[e[i]])},n.setChildZIndex=function(t,e){this.validateChildrenIndex(e),this.addChild(t),this.sortChildren(e)},e}(egret.DisplayObjectContainer);egret.registerClass(CCDisplayObjectContainer,"CCDisplayObjectContainer");var DropDownList=function(t){function e(){t.call(this),this.skinName="resource/skins/component/DropDownListSkin.exml"}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.childrenCreated=function(){this.dropList.visible=!1,this.dropDown.touchEnabled=!0,this.dropScroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.dropDown.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showDropDown,this),this.itemList.itemRenderer=DropDownListItem,this.itemList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelectItem,this)},s.onSelectItem=function(){this.dropList.visible=!1,this.itemList.selectedIndex!=this._lastSelectIndex&&this.updateDisplay()},s.showDropDown=function(){this.dropList.visible=!this.dropList.visible},s.setSelectdIndex=function(t){this.itemList.selectedIndex=t,this.onSelectItem()},s.getSelectedIndex=function(){return this.itemList.selectedIndex},s.updateDisplay=function(){this._lastSelectIndex=this.itemList.selectedIndex,this.selectedItem=this.itemList.selectedItem,this.itemList.selectedItem?this.selected.text=this.itemList.selectedItem.label:this.selected.text="",this.dispatchEventWith(egret.Event.CHANGE)},i(s,"dataProvider",function(){return this._dataProvider},function(t){this._dataProvider=t,this.itemList.dataProvider=this._dataProvider,t.length>0&&(this.itemList.selectedIndex=0),this.updateDisplay()}),e}(eui.Component);egret.registerClass(DropDownList,"DropDownList");var DropDownListItem=function(t){function e(){t.call(this),this.initDisplay()}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.initDisplay=function(){this.left=0,this.right=0,this.height=30,this.stroke=1,this.size=20,this.verticalAlign="middle",this.textAlign="center"},i(s,"data",function(){return this._data},function(t){this._data=t,this.dataChanged()}),s.dataChanged=function(){this.text=this._data.label},e}(eui.Label);egret.registerClass(DropDownListItem,"DropDownListItem",["eui.IItemRenderer","eui.UIComponent"]);var Tabbar=function(t){function e(){t.call(this),this._btnMargin=2,this._contentContainer=new egret.DisplayObjectContainer,this._contentPos=new egret.Point(0,0),this._content=new Dict,this._tabButton=new Dict,this._adaption=new Dict,this.touchEnabled=!0,this.addChild(this._contentContainer),this.setButtonSkin("union-button2","union-button2-a")}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.setButtonSkin=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this._buttonSkins=arguments},s.setContent=function(t,i,n,s,r){void 0===s&&(s=e.ADAPTION_SHOW_ALL),void 0===r&&(r=null),this.pushTabData(n,i,s,t,r),this.invalidateTabbar()},s.pushTabData=function(t,i,n,s,r){void 0===n&&(n=e.ADAPTION_SHOW_ALL),void 0===s&&(s=-1),void 0===r&&(r=null);var o;this._tabButton[s]?o=this._tabButton[s]:(o=new TabbarButton,o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.updateSelectIndex,this)),o.data=r,o.setBtnSkin(this._buttonSkins[0],this._buttonSkins[1]),o.setLabelDisplay(t),-1==s&&(s=Object.keys(this._tabButton).length),i&&i.parent&&i.parent.removeChild(i),this._tabButton[s]=o,this._content[s]=i,this._adaption[s]=n},i(s,"dataProvider",function(){return this._dataProvider},function(t){var e=this;this.reset(),this._dataProvider=t,this._dataProvider.forEach(function(t){e.pushTabData(t.label,t.content,t.adaption,-1,t.data)},this),this.invalidateTabbar()}),s.updateButtonDisplay=function(){if(this._validateProp){for(var t=Object.keys(this._tabButton),e=0,i=0,n=t.length;n>i;i++)this._tabButton[t[i]].x=e+this._btnMargin*i,this._tabButtonWidth?this._tabButton[t[i]].width=this._tabButtonWidth:this._tabButton[t[i]].width=this._tabButton[t[i]].label.textWidth+40,e+=this._tabButton[t[i]].width,this.addChildAt(this._tabButton[t[i]],0),this._content[t[i]]&&this.setContentAdaption(this._content[t[i]],this._adaption[t[i]]);this._validateProp=!1,this.setContentPos(this._contentPos.x,this._contentPos.y),this._selectIndex||(this.selectedIndex=0)}},s.invalidateTabbar=function(){this._validateProp=!0,egret.callLater(this.updateButtonDisplay,this)},i(s,"btnMargin",function(){return this._btnMargin},function(t){this._btnMargin=t,Object.keys(this._tabButton).length>0&&this.invalidateTabbar()}),s.setContentPos=function(t,e){this._contentPos.x=t,this._contentPos.y=e,this._contentContainer.x=this._contentPos.x,this._contentContainer.y=this._contentPos.y,this._tabButton[0]&&(this._tabButton[0].height||this._tabButton[0].validateNow(),this._contentContainer.y+=this._tabButton[0].height)},s.setContentSize=function(t,e){this._contentWidth=t,this._contentHeight=e,this.invalidateTabbar()},s.setContentAdaption=function(t,i){if(!(t.width<=this._contentWidth&&t.height<=this._contentHeight)){var n;i==e.ADAPTION_SHOW_ALL?(n=t.width/t.height>this._contentWidth/this._contentHeight?this._contentWidth/t.width:this._contentHeight/t.height,t.scaleX=t.scaleY=n):i==e.ADAPTION_SCALE?(t.width=this._contentWidth,t.height=this._contentHeight):i==e.ADAPTION_SCROLL&&(n=t.width/t.height>this._contentWidth/this._contentHeight?this._contentHeight/t.height:this._contentWidth/t.width,t.scaleX=t.scaleY=n)}},s.checkScroller=function(){if(!this._scroller){this._scroller=new eui.Scroller,this._scroller.bounces=!1,this._scroller.scrollPolicyH=eui.ScrollPolicy.OFF,this._scroller.width=this._contentWidth,this._scroller.height=this._contentHeight;var t=new eui.Group;this._scroller.viewport=t}},s.setTabButtonWidth=function(t){this._tabButtonWidth=t,this.invalidateTabbar()},i(s,"selectedIndex",function(){return this._selectIndex},function(t){var i=this._tabButton[t];if(this._selectIndex==t)return void i.active();null!=this._selectIndex&&this._tabButton[this._selectIndex].deactive(),this._selectIndex=t,this._tabButton[this._selectIndex]&&this._tabButton[this._selectIndex].active(),this._content[this._selectIndex]&&(this._content[this.selectedIndex]instanceof egret.DisplayObject?(this.clearContainer(),this._content[this._selectIndex].visible=!0,this._adaption[this._selectIndex]==e.ADAPTION_SCROLL?(this.checkScroller(),this._contentContainer.addChild(this._scroller),this._scroller.viewport.addChild(this._content[this._selectIndex])):this._contentContainer.addChild(this._content[this._selectIndex])):this._content[this.selectedIndex]instanceof Function&&this._content[this.selectedIndex](this.selectedIndex));var n=new egret.Event(egret.Event.CHANGE);n.data=this._tabButton[this._selectIndex].data,this.dispatchEvent(n)}),s.clearContainer=function(){this._contentContainer.removeChildren(),this._scroller&&this._scroller.viewport.removeChildren()},s.updateSelectIndex=function(t){for(var e=Object.keys(this._tabButton),i=0,n=e.length;n>i;i++)if(this._tabButton[e[i]]==t.currentTarget){this.selectedIndex=parseInt(e[i]);break}},s.reset=function(){for(var t=Object.keys(this._tabButton),e=0;e<t.length;e++)this._tabButton[t[e]].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.updateSelectIndex,this),this.removeChild(this._tabButton[t[e]]);this._contentContainer.removeChildren(),this._content=new Dict,this._tabButton=new Dict,this._adaption=new Dict},e.ADAPTION_SHOW_ALL="show_all",e.ADAPTION_SCROLL="scroll",e.ADAPTION_SCALE="scale",e.ADAPTION_NONE="none",e}(eui.Component);egret.registerClass(Tabbar,"Tabbar");var superSetter=egret.superSetter,GameTabBar=function(t){function e(){t.call(this),this.setButtonSkin("tabNormal","tabOver")}__extends(e,t);var i=__define,n=e,s=n.prototype;return i(s,"selectedIndex",void 0,function(t){this._selectIndex!=t&&(null!=this._selectIndex&&this._tabButton[this._selectIndex].setState(ButtonState.UP),this._selectIndex=t,this._tabButton[this._selectIndex]&&this._tabButton[this._selectIndex].setState(ButtonState.DOWN),this._contentContainer.removeChildren(),this._contentContainer.addChild(this._content[this._selectIndex]),this.swapChildrenAt(this._selectIndex,Object.keys(this._tabButton).length-1))}),s.setContent=function(t,e,i){this._content[t]=e;var n=new Button;n.buttonWidth=this._tabButtonWidth,n.setBtnSkin(this._buttonSkins[0],this._buttonSkins[1],this._buttonSkins[2]),n.setLabelDisplay(i),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.updateSelectIndex,this),this._tabButton[t]=n,this._validateProp=!0,egret.callLater(this.updateButtonDisplay,this)},e}(Tabbar);egret.registerClass(GameTabBar,"GameTabBar");var HotspotBitmap=function(t){function e(){t.call(this),this._hotspot=[],this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addHotspotArea=function(t,e,i,n){this._hotspot.push({rect:t,callback:e,thisObj:i,para:n})},n.onTouch=function(t){for(var e,i=t.localX,n=t.localY,s=0;s<this._hotspot.length;s++)e=this._hotspot[s],e.rect.contains(i,n)&&(e.para?e.callback.call(e.thisObj,e.para):e.callback.call(e.thisObj))},e}(egret.Bitmap);egret.registerClass(HotspotBitmap,"HotspotBitmap");var ImgButton=function(t){function e(){t.call(this),this.init(),this.touchEnabled=!0,this.touchChildren=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onTouchBegin=function(){this._resArr[1]&&(this._btn.texture=this._resArr[1])},n.onTouchEnd=function(){this._resArr[0]&&(this._btn.texture=this._resArr[0])},n.init=function(){this._btn=new egret.Bitmap,this._label=new egret.TextField,this._label.size=28,this._label.fontFamily="黑体",this._label.textColor=16777215,this._label.textAlign="center",this._label.verticalAlign=egret.VerticalAlign.MIDDLE,this._label.x=25,this._labelImg=new egret.Bitmap,this.addChild(this._btn),this.addChild(this._labelImg),this.addChild(this._label)},n.initRes=function(t,e,i,n){this._resArr=[RES.getRes(t),RES.getRes(e)],this._btn.texture=this._resArr[0],i&&this.setLable(i),n&&(this._labelImg.x=this._btn.width/2,this._labelImg.y=this._btn.height/2,this._labelImg.texture=RES.getRes(n))},n.setLable=function(t){this._label.width=this._btn.width-50,this._label.height=this._btn.height,this._label.text=t},n.setImgLabel=function(t){this._labelImg.texture=RES.getRes(t),this._labelImg.x=this._btn.width/2,this._labelImg.y=this._btn.height/2},e}(egret.DisplayObjectContainer);egret.registerClass(ImgButton,"ImgButton");var ImgNumManager=function(){function t(){this._imgPool=[],this._containerPool=[]}var e=(__define,t),i=e.prototype;return t.i=function(){return this._instance||(this._instance=new t),this._instance},i.createNumPic=function(t,e){var i,n=this.getContainer(),s=t.toString(),r=0;for(r;r<s.length;r++)i=this.getSingleNumPic(s.charAt(r),e),n.addChild(i);return this.repositionNumPic(n),n},i.destroyNumPic=function(t){t.alpha=1,t.visible=!0,t.scaleX=t.scaleY=1,this.clearContainer(t),t.parent&&t.parent.removeChild(t),this._containerPool.push(t)},i.changeNum=function(t,e,i){var n=e.toString();if(t.numChildren>n.length)for(;t.numChildren>n.length;)this.recycleBM(t.getChildAt(t.numChildren-1));var s,r=0;for(r;r<n.length;r++)r>=t.numChildren&&t.addChild(this.getBitmap()),s=n.charAt(r),s="."==s?"dot":s,t.getChildAt(r).texture=RES.getRes(i+s);this.repositionNumPic(t)},i.repositionNumPic=function(t){var e,i=0,n=0;for(i;i<t.numChildren;i++)e=t.getChildAt(i),e.x=n,n=e.x+e.width},i.clearContainer=function(t){for(;t.numChildren;)this.recycleBM(t.removeChildAt(0))},i.recycleBM=function(t){t&&t.parent&&(t.parent.removeChild(t),t.texture=null,this._imgPool.push(t))},i.getContainer=function(){return this._containerPool.length?this._containerPool.shift():new egret.DisplayObjectContainer},i.getSingleNumPic=function(t,e){"."==t&&(t="dot");var i=this.getBitmap();return i.texture=RES.getRes(e+t),i},i.getBitmap=function(){return this._imgPool.length?this._imgPool.shift():new egret.Bitmap},t}();egret.registerClass(ImgNumManager,"ImgNumManager");var MovieClip=function(t){function e(){t.call(this),this._currentFrame=0,this._pastTime=0,this.frameRate=30,this.touchEnabled=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return i(s,"frameRate",function(){return this._frameRate},function(t){this._frameRate=t,this._frameTime=Math.abs(1e3/t)}),s.setFrameData=function(t){this._frameKeys=t,this._totalFrame=this._frameKeys.length,this._frameTexture=[];for(var e=!0,i=0;i<this._totalFrame;i++)if(null==RES.getRes(this._frameKeys[i])){e=!1;break}e?this.initResource():(this._loadGroupName="group"+Math.random(),RES.createGroup(this._loadGroupName,t),RES.loadGroup(this._loadGroupName),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResLoaded,this))},s.initResource=function(){for(var t=0,e=this._totalFrame;e>t;t++)this._frameTexture.push(RES.getRes(this._frameKeys[t]));this.texture=this._frameTexture[0],this._pastTime=0},s.onResLoaded=function(t){t.groupName==this._loadGroupName&&this.initResource()},s.play=function(t){void 0===t&&(t=-1),-1!=this._ticker&&this.stop(),this._playCount=t,this._currentFrame=0,this._ticker=Api.TimerManager.startTicker(this.enterFrame,this)},s.resume=function(){this._ticker=Api.TimerManager.startTicker(this.enterFrame,this)},s.stop=function(){Api.TimerManager.remove(this._ticker),this._ticker=-1},s.removeFromStage=function(){this._autoStop=!0,this.stop()},s.addToStage=function(){this._autoStop&&this.play(this._playCount)},s.enterFrame=function(t){this._frameTexture&&this._frameTexture.length&&(this._pastTime+=t,this._pastTime<this._frameTime||(this._currentFrame++,this._pastTime=0,this._currentFrame>=this._totalFrame&&(this._currentFrame=0,-1!=this._playCount&&(this._playCount--,0==this._playCount&&this.over())),this.texture=this._frameTexture[this._currentFrame]))},s.over=function(){this.stop(),this._currentFrame=0},s.reset=function(){this.stop(),this._frameTexture=[],this._frameKeys=[],this._totalFrame=0,this._pastTime=0,this._autoStop=!1},e}(egret.Bitmap);egret.registerClass(MovieClip,"MovieClip");var MovieClipPool=function(){function t(){this._pool=[]}var e=(__define,t),i=e.prototype;return t.i=function(){return this._instance||(this._instance=new t),this._instance},i.recycleMC=function(t){t.reset(),t.parent&&t.parent.removeChild(t),this._pool.push(t)},i.getMC=function(){return this._pool.length?this._pool.shift():new MovieClip},t}();egret.registerClass(MovieClipPool,"MovieClipPool");var ScaleView=function(t){function e(e){t.call(this),this.maxScale=2,this.minScale=.5,this.beginVector=[],this.beginScale=1,this.beginX=0,this.beginY=0,this._content=e,this.touchEnabled=!0,this.addChild(e),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onAdd=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.stage.addEventListener(egret.Event.LEAVE_STAGE,this.onTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)},n.setScaleRange=function(t,e){this.maxScale=e,this.minScale=t},n.onTouchBegin=function(t){e.pointMap[t.touchPointID]=[t.stageX,t.stageY];var i=Object.keys(e.pointMap),n=i.length;if(n>=2){var s=e.pointMap[i[0]],r=e.pointMap[i[1]];this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.beginVector=[r[0]-s[0],r[1]-s[1]],this.beginScale=this._content.scaleX,this.beginX=this._content.x,this.beginY=this._content.y}},n.onTouchMove=function(t){e.pointMap[t.touchPointID]=[t.stageX,t.stageY];var i=Object.keys(e.pointMap),n=i.length;if(n>=2){var s=e.pointMap[i[0]],r=e.pointMap[i[1]],o=[r[0]-s[0],r[1]-s[1]],a=this.getScale(o),h=a*this.beginScale;this.scaleWithPoint(h,this.getScalePoint())}},n.onTouchEnd=function(t){delete e.pointMap[t.touchPointID];var i=Object.keys(e.pointMap).length;2>i&&this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)},n.getScalePoint=function(){for(var t=[0,0],i=Object.keys(e.pointMap),n=0;2>n;n++)t[0]+=e.pointMap[i[n]][0],t[1]+=e.pointMap[i[n]][1];return t[0]=Math.round(t[0]/2),t[1]=Math.round(t[1]/2),t},n.getVectorLength=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},n.getScale=function(t){var e=this.getVectorLength(t),i=this.getVectorLength(this.beginVector);return e/i},n.scaleWithPoint=function(t,e){if(!(t<this.minScale||t>this.maxScale)){var i=this._content.globalToLocal(e[0],e[1]),i=new egret.Point(i.x,i.y),n=this.beginX-i.x*(t-this.beginScale),s=this.beginY-i.y*(t-this.beginScale);this._content.x=n,this._content.y=s,this._content.scaleX=t,this._content.scaleY=t}},e.pointMap={},e}(egret.DisplayObjectContainer);egret.registerClass(ScaleView,"ScaleView");var ScrollRectView=function(t){function e(e,i,n,s){t.call(this),this.viewRect=new egret.Rectangle(0,0,e,i),this._totalHeight=s,this._totalWidth=n,this._viewSavePoint=new egret.Point,this.progressX=0,this.progressY=0,this.positionX=0,this.positionY=0,this._lastPositionX=0,this._lastPositionY=0,this._scrollEnabled=!0}__extends(e,t);var i=__define,n=e,s=n.prototype;return i(s,"content",void 0,function(t){this._showContent=t,this._showContent.touchEnabled=!0,this.updateView()}),s.updateView=function(){this.addChild(this._showContent),this.setEvent()},s.setEvent=function(){this._showContent.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this._showContent.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this._showContent.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this._showContent.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),this._showContent.addEventListener(egret.Event.RESIZE,this.onContentResize,this)},s.onContentResize=function(){this.validate()},s.onTouchBegin=function(t){this._scrollEnabled&&(egret.Tween.removeTweens(this),this._viewSavePoint?(this._viewSavePoint.x=t.stageX,this._viewSavePoint.y=t.stageY):this._viewSavePoint=new egret.Point(t.stageX,t.stageY),this._rollSpeedX=0,this._rollSpeedY=0,egret.startTick(this.checkSpeed,this))},s.checkSpeed=function(t){return!0},s.onTouchEnd=function(t){this._scrollEnabled&&(this._viewSavePoint=null,this.slide(),this._isMoving=!1)},s.onTouchMove=function(t){this._scrollEnabled&&(this._viewSavePoint||(this._viewSavePoint=new egret.Point(t.stageX,t.stageY)),this._rollSpeedX=t.stageX-this._viewSavePoint.x,this._rollSpeedY=t.stageY-this._viewSavePoint.y,this._viewSavePoint.x=t.stageX,this._viewSavePoint.y=t.stageY,(this._rollSpeedX>3||this._rollSpeedX<-3||this._rollSpeedY>3||this._rollSpeedY<-3)&&(this._showContent.x+=this._rollSpeedX,this._showContent.y+=this._rollSpeedY,this.validate(),this.setPosition(),this._isMoving||(this._isMoving=!0)))
},s.setPosition=function(t){"y"!=t&&(this.positionX=Math.abs(this._showContent.x/this._showContent.scaleX),this.progressX=-this._showContent.x/(this._totalWidth-this.viewRect.width)/this._showContent.scaleX),"x"!=t&&(this.positionY=Math.abs(-this._showContent.y/this._showContent.scaleY),this.progressY=-this._showContent.y/(this._totalHeight-this.viewRect.height)/this._showContent.scaleY),this.onMove()},s.validate=function(t){var e=this._showContent.x,i=this._showContent.y;"y"!=t&&(e<this.viewRect.width-this._totalWidth*this._showContent.scaleX&&(e=this.viewRect.width-this._totalWidth*this._showContent.scaleX),e>0&&(e=0),this._showContent.x=e),"x"!=t&&(i<this.viewRect.height-this._totalHeight*this._showContent.scaleY&&(i=this.viewRect.height-this._totalHeight*this._showContent.scaleY),i>0&&(i=0),this._showContent.y=i)},s.updateMask=function(){this.viewRect.x=-this._showContent.x/this._showContent.scaleX,this.viewRect.y=-this._showContent.y/this._showContent.scaleY,this._showContent.mask=this.viewRect},s.validateAndTween=function(){var t=this,e=this._showContent.x,i=this._showContent.y;e<this.viewRect.width-this._totalWidth*this._showContent.scaleX&&(e=this.viewRect.width-this._totalWidth*this._showContent.scaleX),e>0&&(e=0),i<this.viewRect.height-this._totalHeight*this._showContent.scaleY&&(i=this.viewRect.height-this._totalHeight*this._showContent.scaleY),i>0&&(i=0),this._isTweening=!0,egret.Tween.get(this,{onChange:this.setPosition,onChangeObj:this}).to({slideXNoValidate:e,slideYNoValidate:i},300,egret.Ease.quadOut).call(function(){t._isTweening=!1},this)},s.slide=function(){if(!this._isTweening){var t=Math.max(Math.abs(this._rollSpeedX),Math.abs(this._rollSpeedY)),e=this._showContent.x+this._rollSpeedX*t/5,i=this._showContent.y+this._rollSpeedY*t/5,n=400+t/12;egret.Tween.get(this,{onChange:this.setPosition,onChangeObj:this}).to({slideX:e,slideY:i},n,egret.Ease.quadOut)}},s.onMove=function(){return Math.abs(this._lastPositionX-this.positionX)>10&&(this.dispatchMove(),Math.abs(this._lastPositionX-this.positionX)>50)?void this.dispatchUpdate():void(Math.abs(this._lastPositionY-this.positionY)>10&&(this.dispatchMove(),Math.abs(this._lastPositionY-this.positionY)>50&&this.dispatchUpdate()))},s.dispatchMove=function(){this.dispatchEvent(new egret.Event(e.EVENT_PROGRESS_MOVE))},s.dispatchUpdate=function(){this._lastPositionX=this.positionX,this._lastPositionY=this.positionY,this.dispatchEvent(new egret.Event(e.EVENT_PROGRESS_UPDATE))},i(s,"slideXNoValidate",function(){return this._showContent.x},function(t){this._showContent.x=t,this.setPosition("x")}),i(s,"slideYNoValidate",function(){return this._showContent.y},function(t){this._showContent.y=t,this.setPosition("y")}),i(s,"slideX",function(){return this._showContent.x},function(t){this._showContent.x=t,this.validate("x"),this.setPosition("x")}),i(s,"slideY",function(){return this._showContent.y},function(t){this._showContent.y=t,this.validate("y"),this.setPosition("y")}),i(s,"showContent",function(){return this._showContent}),s.setViewPosition=function(t,e){this._showContent.x=-t*this._showContent.scaleX,this._showContent.y=-e*this._showContent.scaleY,this.validate(),this.setPosition()},i(s,"scrollEnabled",void 0,function(t){this._scrollEnabled=t,egret.Tween.removeTweens(this),t&&this.validateAndTween()}),e.EVENT_PROGRESS_UPDATE="event_progress_update",e.EVENT_PROGRESS_MOVE="event_progress_move",e}(egret.DisplayObjectContainer);egret.registerClass(ScrollRectView,"ScrollRectView");var TabbarButton=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setBtnSkin=function(t,e){this.up.source=t,this.down.source=e},n.setLabelDisplay=function(t){"string"==typeof t?this.label.text=t:(this._labelDis=t,this.addChild(this._labelDis),this.label.visible=!1)},n.init=function(){this.up=new eui.Image,this.down=new eui.Image,this.down.visible=!1,this.addChild(this.up),this.addChild(this.down),this.label=new eui.Label,this.label.verticalCenter=0,this.label.horizontalCenter=0,this.label.size=26,this.label.bold=!0,this.label.fontFamily="黑体",this.label.textColor=16777215,this.label.fontFamily="SimHei",this.fill(this.up),this.fill(this.down),this.addChild(this.label)},n.fill=function(t){t.scale9Grid=new egret.Rectangle(23,24,60,26),t.top=0,t.bottom=0,t.left=0,t.right=0},n.active=function(){this.up.visible=!1,this.down.visible=!0,this.label.textColor=16773376},n.deactive=function(){this.up.visible=!0,this.down.visible=!1,this.label.textColor=16777215},n.setButtonWidth=function(t){this.width=t},e}(eui.Group);egret.registerClass(TabbarButton,"TabbarButton");var TabbarButtonData=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(TabbarButtonData,"TabbarButtonData");var UnderLineLabel=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.init=function(){this._label=new egret.TextField,this._underLine=new egret.Shape,this.addChild(this._label),this.addChild(this._underLine)},i(s,"text",function(){return this._label.text},function(t){this._label.text=t,this.updateUnderLine()}),s.updateUnderLine=function(){var t=this;egret.callLater(function(){var e=t.getLabelBounds();t._underLine.graphics.clear(),t._underLine.graphics.lineStyle(2,t._label.textColor),t._underLine.graphics.moveTo(e.x,e.y+e.height),t._underLine.graphics.lineTo(e.x+e.width,e.y+e.height)},this)},s.getLabelBounds=function(){var t=new egret.Rectangle;return t.width=this._label.textWidth,t.height=this._label.textHeight,this._label.textAlign==egret.HorizontalAlign.LEFT?t.x=0:this._label.textAlign==egret.HorizontalAlign.CENTER?t.x=(this._label.width-this._label.textWidth)/2:this._label.textAlign==egret.HorizontalAlign.RIGHT&&(t.x=this._label.width-this._label.textWidth),this._label.verticalAlign==egret.VerticalAlign.TOP?t.y=0:this._label.verticalAlign==egret.VerticalAlign.MIDDLE?t.y=(this._label.height-this._label.textHeight)/2:this._label.verticalAlign==egret.VerticalAlign.BOTTOM&&(t.y=this._label.height-this._label.textHeight),t},i(s,"label",function(){return this._label}),e}(egret.DisplayObjectContainer);egret.registerClass(UnderLineLabel,"UnderLineLabel");var Dict=function(){function t(){return Object.create(null)}var e=(__define,t);e.prototype;return t}();egret.registerClass(Dict,"Dict");var SimpleLoading=function(){function t(){}var e=(__define,t),i=e.prototype;return t.i=function(){return this._instance||(this._instance=new t),this._instance},i.showLoading=function(){},i.hideLoading=function(){},i.setProgress=function(t){},t}();egret.registerClass(SimpleLoading,"SimpleLoading");var BaseModule=function(){function t(){}var e=(__define,t),i=e.prototype;return i.regMsgListener=function(t,e){Api.MessageCenter.regMsgListener(t,e,this)},i.sendMsg=function(t){Api.GameSocket.sendMsg(t)},t}();egret.registerClass(BaseModule,"BaseModule");var ModuleManager=function(){function t(){this._modules=Object.create(null)}var e=(__define,t),i=e.prototype;return i.regModule=function(t,e){return this._modules[t]?void console.error("duplicate module reg:"+t):void(this._modules[t]=new e)},i.getModule=function(t){return this._modules[t]?this._modules[t]:(console.error("cant find module:"+t),null)},t}();egret.registerClass(ModuleManager,"ModuleManager");var GlobalRes=function(){function t(){this._textBaseConfig={},this._textConfig={},this.setLanguage()}var e=(__define,t),i=e.prototype;return i.setLanguage=function(e){var i;if(i=e?e:egret.getOption("lang"),i==Lang.LANG_CN||i==Lang.LANG_EN||i==Lang.LANG_TW)t.Lang=i;else{var n=navigator.userAgent;-1!=n.indexOf("; "+Lang.LANG_EN)?t.Lang=Lang.LANG_EN:-1!=n.indexOf("; "+Lang.LANG_CN)?t.Lang=Lang.LANG_CN:-1!=n.indexOf("; "+Lang.LANG_TW)?t.Lang=Lang.LANG_TW:t.Lang=Lang.LANG_CN}},i.initTextBaseConfig=function(t){this._textBaseConfig=t},i.initTextConfig=function(t){this._textConfig=t},i.initGameConfig=function(t){this._config=t,this._config&&EventCenter.dispatchWith("config_complete")},i.getConfig=function(t){var e=t.split(".");return this.getConfigByParas(e[0],e[1],e[2])},i.getConfigByParas=function(t,e,i){return i?this._config[t][e][i]:e?this._config[t][e]:this._config[t]},i.getText=function(t){return this._textConfig[t]?this._textConfig[t]:this._textBaseConfig[t]?this._textBaseConfig[t]:(console.log("Global Text '"+t+"' not defined!"),"")},i.getNotice=function(t){var e="notice_"+t;return this._textConfig[e]?this._textConfig[e]:this._textBaseConfig[e]?this._textBaseConfig[e]:(console.log("Global Text '"+e+"' not defined!"),"")},t}();egret.registerClass(GlobalRes,"GlobalRes");var Layers=function(){function t(t){this.init(t)}var e=(__define,t),i=e.prototype;return i.init=function(t){this._layers||(this._layers={},this.addLayer(this._layers,LayerType.BACKGROUND,t),this.addLayer(this._layers,LayerType.GAME,t),this.addLayer(this._layers,LayerType.UI_BOTTOM,t),this.addLayer(this._layers,LayerType.UI,t),this.addLayer(this._layers,LayerType.UI_TOP,t),this.addLayer(this._layers,LayerType.TIPS,t),this.addLayer(this._layers,LayerType.GUIDE,t),this.addLayer(this._layers,LayerType.ALERT,t),this.resizeLayer())},i.addLayer=function(t,e,i){var n=new eui.Group;n.touchEnabled=!1,t[e]=n,i.addChild(n)},i.resizeLayer=function(){for(var t in this._layers)this._layers[t].width=Api.StageUtil.stageWidth,this._layers[t].height=Api.StageUtil.stageHeight},i.getLayer=function(t){return this._layers[t]},i.getLayers=function(){return this._layers},t}();egret.registerClass(Layers,"Layers");var LayerType=function(){function t(){}var e=(__define,t);e.prototype;return t.ALERT="alert",t.GUIDE="guide",t.TIPS="tips",t.UI_TOP="ui_top",t.UI="ui",t.UI_BOTTOM="ui_bottom",t.GAME="game",t.BACKGROUND="background",t}();egret.registerClass(LayerType,"LayerType");var StageUtil=function(){function t(t){this.init(t)}var e=(__define,t),i=e.prototype;return i.init=function(t){this.stage=t,this.stageHeight=t.stageHeight,this.stageWidth=t.stageWidth,this.stage.addEventListener(egret.Event.RESIZE,this.resizeStage,this)},i.resizeStage=function(){this.stageHeight=this.stage.stageHeight,this.stageWidth=this.stage.stageWidth,Api.Layers.resizeLayer()},t}();egret.registerClass(StageUtil,"StageUtil");var TimerManager=function(){function t(){this._handlers=new Dict,this._timeCall=new Dict,this._id=0,egret.startTick(this.onFrame,this),this._lastTimestamp=egret.getTimer(),this._serverTime=(new Date).getTime()}var e=(__define,t),i=e.prototype;return i.setServerTime=function(t){this._serverTime=1e3*t},i.getTime=function(){return parseInt(this._serverTime+"")},i.regTimeCall=function(t,e,i,n,s){var r,o=new Date(this._serverTime).getTime(),a=new Date;a.setHours(t),a.setMinutes(e),a.setSeconds(0),a.setMilliseconds(0);var h=a.getTime();if(o>h){var l=new Date;l.setHours(24),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0),r=l.getTime()-o,r+=36e5*t+6e4*e}else r=h-o;var c=new TimerHandler;return c.callback=i,c.callObj=n,c.repeatCount=1,c.callPara=s,c.timeScale=r,this.addHandler(c)},i.regCountdown=function(t,e,i,n,s){var r=new TimerHandler;return r.callback=e,r.callObj=n,r.completeCallBack=i,r.repeatCount=t,r.timeScale=1e3,r.callPara=s,this.addHandler(r)},i.startTicker=function(t,e,i){var n=new TimerHandler;return n.callback=t,n.callObj=e,n.timeScale=0,n.callPara=i,this.addHandler(n)},i.setTimeout=function(t,e,i,n){var s=new TimerHandler;return s.callback=t,s.callObj=e,s.timeScale=i,s.repeatCount=1,s.callPara=n,this.addHandler(s)},i.setInterval=function(t,e,i,n){var s=new TimerHandler;return s.callback=t,s.callObj=e,s.timeScale=i,s.callPara=n,this.addHandler(s)},i.onFrame=function(t){var e=t-this._lastTimestamp;this._lastTimestamp=t,this._serverTime+=e;for(var i,n=Object.keys(this._handlers),s=n.length-1;s>=0;s--)i=this._handlers[n[s]],i&&(i.isPause||(i.timePast+=e),!i.isPause&&i.timePast>=i.timeScale&&(i.repeatCount>0&&i.repeatCount--,i.callback&&(i.callPara?i.callback.call(i.callObj,i.callPara):null!=i.repeatCount?i.callback.call(i.callObj,i.repeatCount):i.callback.call(i.callObj,e)),0==i.repeatCount&&(i.completeCallBack&&i.completeCallBack.call(i.callObj),delete this._handlers[n[s]]),i.timePast-=i.timeScale));return!0},i.pauseHandler=function(t,e){void 0===e&&(e=!0),this._handlers[t].isPause=e},i.remove=function(t){delete this._handlers[t]},i.addHandler=function(t){return this._handlers[++this._id]=t,this._id},t}();egret.registerClass(TimerManager,"TimerManager");var TimerHandler=function(){function t(){this.timePast=0}var e=(__define,t);e.prototype;return t}();egret.registerClass(TimerHandler,"TimerHandler");var Dialogue=function(){function t(){}var e=(__define,t),i=e.prototype;return i.regConfirm=function(t){this._confirm=t},i.regDialogue=function(t){this._dialogue=t},i.confirm=function(t,e){this._confirm.openView(arguments)},i.dialogue=function(t,e,i,n,s){this._dialogue.openView(arguments)},t}();egret.registerClass(Dialogue,"Dialogue");var TipsManager=function(){function t(){this._margin=5,this._maxTips=5,this._fadeTime=2e3,this._moveDis=150,this._tipsPool=[],this._currTips=[]}var e=(__define,t),i=e.prototype;return i.setItemType=function(t){this._itemType=t},i.setProp=function(t){t.margin&&(this._margin=t.margin),t.fadeTime&&(this._fadeTime=t.fadeTime),t.moveDis&&(this._moveDis=t.moveDis),t.maxTips&&(this._maxTips=t.maxTips)},i.showTips=function(t){var e=this.getTips();if(e.onShow(t),e.x=(Api.StageUtil.stageWidth-e.width)/2,e.y=Api.StageUtil.stageHeight/2,this._currTips.length){var i=this._currTips[this._currTips.length-1];e.y=i.y+i.height+this._margin}this._currTips.length>this._maxTips&&this.recycleTip(this._currTips[0]),Api.Layers.getLayer(LayerType.TIPS).addChild(e),this._currTips.push(e),this.moveTips(e)},i.moveTips=function(t){var e=t.y-this._moveDis;egret.Tween.get(t).to({y:e},this._fadeTime).call(this.onMoveEnd,this,[t])},i.onMoveEnd=function(t){this.recycleTip(t)},i.showTipsByKey=function(t){this.showTips(Api.GlobalRes.getText(t))},i.getTips=function(){if(this._tipsPool.length)return this._tipsPool.pop();var t=new this._itemType;return t.touchEnabled=!1,t},i.recycleTip=function(t){this._currTips.shift(),egret.Tween.removeTweens(t),t.stage&&Api.Layers.getLayer(LayerType.TIPS).removeChild(t),this._tipsPool.push(t),t.onHide()},t}();egret.registerClass(TipsManager,"TipsManager");var URLLoaderPool=function(){function t(){this._loaderPool=[],this._loaderCallBack=new Dict}var e=(__define,t),i=e.prototype;return i.load=function(t,e,i,n,s){void 0===n&&(n=egret.URLRequestMethod.POST);var r=this.getNewLoader(),o=r._request;if(o.method=n,o.url=t,s){var a=new egret.URLVariables;a.variables=s}o.data=a,this._loaderCallBack[r.hashCode]={call:e,obj:i},r.load(o)},i.recycleLoader=function(t){this._loaderPool.push(t)},i.getNewLoader=function(){if(this._loaderPool.length)return this._loaderPool.shift();var t=new egret.URLLoader;this.initLoaderEvent(t);var e=new egret.URLRequest;return t._request=e,t},i.initLoaderEvent=function(t){t.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this)},i.onLoadComplete=function(t){var e=this._loaderCallBack[t.currentTarget.hashCode];e.call.call(e.obj,t.currentTarget.data),t.currentTarget._request.data=null,this.recycleLoader(t.currentTarget),delete this._loaderCallBack[t.currentTarget.hashCode]},i.onLoadError=function(t){Api.Log.error("urlloader ioerror :"+t.currentTarget._request.url),this.recycleLoader(t.currentTarget),t.currentTarget._request.data=null,delete this._loaderCallBack[t.currentTarget.hashCode]},t}();egret.registerClass(URLLoaderPool,"URLLoaderPool");var ArrayUtil=function(){function t(){}var e=(__define,t),i=e.prototype;return i.sortBy=function(t,e){t.sort(this.sortByKeyFun(e))},i.sortByKeyFun=function(t){return function(e,i){return e[t]>i[t]?-1:e[t]==i[t]?0:1}},i.getRandomArray=function(t){for(var e=[],i=0;t>i;i++)e.push(i);return e.sort(this.randomSort)},i.randomSort=function(t,e){return Math.random()>.5?-1:1},t}();egret.registerClass(ArrayUtil,"ArrayUtil");var DateUtil=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getFormatBySecond=function(t,e){void 0===e&&(e=1);var i="";switch(e){case 1:i=this.getFormatBySecond1(t);break;case 2:i=this.getFormatBySecond2(t);break;case 3:i=this.getFormatBySecond3(t);break;case 4:i=this.getFormatBySecond4(t);break;case 5:i=this.getFormatBySecond5(t);break;case 6:i=this.getFormatBySecond6(t)}return i},i.getFormatBySecond1=function(t){void 0===t&&(t=0);var e,i=Math.floor(t/3600);e=0==i?"00":10>i?"0"+i:""+i;var n,s,r=Math.floor((t-3600*i)/60),o=Math.floor((t-3600*i)%60);return n=0==r?"00":10>r?"0"+r:""+r,s=0==o?"00":10>o?"0"+o:""+o,e+":"+n+":"+s},i.getFormatBySecond6=function(t){var e=Math.floor(t/3600),i=Math.floor((t-3600*e)/60);return e+Api.GlobalRes.getText("hour")+i+Api.GlobalRes.getText("minute")},i.getFormatBySecond3=function(t){void 0===t&&(t=0);var e,i,n=Math.floor(t/3600),s=Math.floor((t-3600*n)/60),r=Math.floor((t-3600*n)%60);return e=0==s?"00":10>s?"0"+s:""+s,i=0==r?"00":10>r?"0"+r:""+r,e+":"+i},i.getFormatBySecond2=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,s=e.getDate(),r=e.getHours(),o=e.getMinutes(),a=e.getSeconds();return i+"-"+n+"-"+s+" "+r+":"+o+":"+a},i.getFormatBySecond4=function(t){var e=Math.floor(t/3600);return e>0?e>24?Math.floor(e/24)+"天前":e+"小时前":Math.floor(t/60)+"分钟前"},i.getFormatBySecond5=function(t){var e=86400,i=3600,n=60,s=Math.floor(t/e),r=Math.floor(t%e/i),o=Math.floor((t-r*i)/n),a=Math.floor((t-r*i)%n),h="",l="",c="",u="";return t>0?0==s?(h="",0==r?(l="",0==o?(c="",u=0==a?"":10>a?"0"+a+"秒":""+a+"秒"):(c=""+o+"分",u=0==a?"":10>a?"0"+a+"秒":""+a+"秒",c+u)):(l=r+"小时",0==o?(c="",u=0==a?"":10>a?"0"+a+"秒":""+a+"秒"):(c=10>o?"0"+o+"分":""+o+"分",l+c))):(h=s+"天",l=0==r?"":10>r?"0"+r+"小时":""+r+"小时",h+l):""},i.getTimeInfo=function(){var t=new Date;return t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()},t}();egret.registerClass(DateUtil,"DateUtil");var DelayOptManager=function(){function t(){this.TIME_THRESHOLD=3,this._delayOpts=[]}var e=(__define,t),i=e.prototype;return t.i=function(){return this._instance||(this._instance=new t),this._instance},i.addDelayOptFunction=function(t,e,i,n,s){this._delayOpts.push({fun:e,funPara:i,thisObj:t,callback:n,para:s}),egret.startTick(this.runCachedFun,this)},i.runCachedFun=function(t){this._delayOpts.length||egret.stopTick(this.runCachedFun,this);for(var e,i=egret.getTimer();this._delayOpts.length&&(e=this._delayOpts.shift(),void 0!=e.funPara?e.fun.call(e.thisObj,e.funPara):e.fun.call(e.thisObj),e.callback&&(void 0!=e.para?e.callback.call(e.thisObj,e.para):e.callback()),!(egret.getTimer()-i>this.TIME_THRESHOLD)););return!0},t}();egret.registerClass(DelayOptManager,"DelayOptManager");var LocationProperty=function(){function t(){}var e=(__define,t);e.prototype;return t.getPara=function(t,e){var i=e||location.href;if(-1!=i.indexOf("?")){var n="&"+i.split("?")[1],s=new RegExp("&"+t+"=.*?(?:&|$)"),r=s.exec(n);if(r){var o=r[0];return o.split("&")[1].split("=")[1]}}return null},t.setProperty=function(t,e,i){var n=i||location.href,s="&"+n.split("?")[1];if(-1==n.indexOf("?"))return n+="?"+t+"="+e;var s=n.split("?")[1];if(""==s)return n+=t+"="+e;var r=new RegExp("(?:^|&)"+t+"=.*?(?:&|$)"),o=r.exec(s);if(o&&""!=o[0]){var a=o[0],h=new RegExp("=.*$"),l=a.replace(h,"="+e);return n.replace(a,l)}return n+="&"+t+"="+e},t.hasProperty=function(t,e){var i="&"+e.split("?")[1];return-1!=i.indexOf("&"+t+"=")},t}();egret.registerClass(LocationProperty,"LocationProperty");var Log=function(){function t(){this._logLevel=LogLevel.ERROR,"1"==egret.getOption("debug")&&(this._logLevel=LogLevel.DEBUG)}var e=(__define,t),i=e.prototype;return i.setLevel=function(t){this._logLevel=t},i.debug=function(t){this._logLevel<=LogLevel.DEBUG&&(t instanceof Object&&(t=JSON.stringify(t)),console.debug("["+Api.DateUtil.getTimeInfo()+"]"+t))},i.info=function(t){this._logLevel<=LogLevel.INFO&&(t instanceof Object&&(t=JSON.stringify(t)),console.log("["+Api.DateUtil.getTimeInfo()+"]"+t))},i.warn=function(t){this._logLevel<=LogLevel.WARN&&(t instanceof Object&&(t=JSON.stringify(t)),console.warn("["+Api.DateUtil.getTimeInfo()+"]"+t))},i.error=function(t){this._logLevel<=LogLevel.ERROR&&(t instanceof Object&&(t=JSON.stringify(t)),console.error("["+Api.DateUtil.getTimeInfo()+"]"+t))},i.fatal=function(t){this._logLevel<=LogLevel.FATAL&&(t instanceof Object&&(t=JSON.stringify(t)),console.error("["+Api.DateUtil.getTimeInfo()+"]"+t))},t}();egret.registerClass(Log,"Log");var LogLevel;!function(t){t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR",t[t.FATAL=4]="FATAL"}(LogLevel||(LogLevel={}));var MathUtils=function(){function t(){this.PI=3.14}var e=(__define,t),i=e.prototype;return i.angleToArc=function(t){return t/180*this.PI},i.distance=function(t,e,i,n){var s=Math.pow(i-t,2)+Math.pow(n-e,2);return Math.sqrt(s)},i.pointDistance=function(t,e){return this.distance(t.x,t.y,e.x,e.y)},i.getArc=function(t,e,i,n){return Math.atan2(n-e,i-t)},i.getAngle=function(t,e,i,n){return Math.atan2(n-e,i-t)/this.PI*180},t}();egret.registerClass(MathUtils,"MathUtils");var NumberFormat=function(){function t(){}var e=(__define,t),i=e.prototype;return i.formatNumber=function(t){return this.formatString(t+"")},i.formatString=function(t){var e=t.length;if(5>e)return t;var i,n=Math.floor((e-1)/3);1==n?i="K":2==n?i="M":3==n&&(i="B");for(var s="",r=0,o=e-1;o>=0;o--)r++,s=t.charAt(o)+s,r%3==0&&0!=o&&(s="."+s);return s=s.slice(0,4),"."==s.charAt(3)&&(s=s.slice(0,3)),s+i},i.formatString2=function(t){var e=t.length;if(8>e)return t;var i,n=Math.floor((e-1)/3);1==n?i="K":2==n?i="M":3==n&&(i="B");for(var s="",r=0,o=e-1;o>=0;o--)r++,s=t.charAt(o)+s,r%3==0&&0!=o&&(s="."+s);return s=s.slice(0,6),"."==s.charAt(5)&&(s=s.slice(0,5)),s+i},t}();egret.registerClass(NumberFormat,"NumberFormat");var ResourceUtil=function(){function t(){this._groupIndex=0,this._configs=new Array,this._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceLoadProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this)}var e=(__define,t),i=e.prototype;return i.addConfig=function(t,e){this._configs.push([t,e])},i.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},i.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},i.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},i.loadGroup=function(t,e,i,n){this._groups[t]=[e,i,n],RES.loadGroup(t)},i.loadGroups=function(t,e,i,n,s){RES.createGroup(t,e,!0),this.loadGroup(t,i,n,s)},i.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var i="pilferer_"+t;e||(e=[t]),RES.createGroup(i,e,!0),RES.loadGroup(i,-1)},i.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][0],n=this._groups[e][2];null!=i&&i.call(n),this._groups[e]=null,delete this._groups[e]}},i.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][1],n=this._groups[e][2];null!=i&&i.call(n,t.itemsLoaded,t.itemsTotal)}},i.onResourceLoadError=function(t){Api.Log.error(t.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(t)},i.loadResource=function(t,e,i,n){void 0===t&&(t=[]),void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null);var s="loadGroup"+this._groupIndex++;RES.createGroup(s,t,!0),this._groups[s]=[e,i,n];try{RES.loadGroup(s)}catch(r){console.log("group empty::"+JSON.stringify(t))}},i.loadPicAsyn=function(t,e,i,n){RES.getResByUrl(t,function(t){e.texture=t,i&&(e.width=i,e.height=n)},this)},t}();egret.registerClass(ResourceUtil,"ResourceUtil");var TextFlowMaker=function(){function t(){}var e=(__define,t),i=e.prototype;return i.makeTextFlow=function(t){var e=[];if(!t||""==t)return[];var i;for(t=t.replace(/\\\{/g,"|Saco|"),t=t.replace(/\\\}/g,"|Sacoz|"),t=t.replace(/\\\,/g,"|Saco1|"),t=t.replace(/\\\:/g,"|Saco2|");t.length;)if(i=t.indexOf("{"),i>0)e.push(this.getTextFlowElement(t.slice(0,t.indexOf("{")))),t=t.slice(t.indexOf("{"));else{if(0!=i){e.push(this.getTextFlowElement(t));break}e.push(this.getTextFlowElement(t.slice(i,t.indexOf("}")+1))),t=t.slice(t.indexOf("}")+1)}return e},i.getTextFlowElement=function(t){var e=new TextFlowElement;if("{"==t.charAt(0)){t=t.replace(/ *, */g,'","'),t=t.replace(/ *: */g,'":"'),t=t.replace(/\{/g,'{"'),t=t.replace(/}/g,'"}');var i=JSON.parse(t);e.text=this.resumeText(i.t),e.style=new TextFlowElementStyle,e.style.textColor=i.c,e.style.size=i.s,e.style.underline=i.u,e.style.italic=i.i,e.style.bold=i.b,e.style.stroke=i.st,e.style.strokeColor=i.sc,e.style.fontFamily=i.f,e.style.target=i.ta,i.h&&(e.style.href=i.h),i.e&&(e.style.href="event:"+i.e)}else e.text=this.resumeText(t);return e},i.resumeText=function(t){return t=t.replace(/\|Saco\|/g,"{"),t=t.replace(/\|Sacoz\|/g,"}"),t=t.replace(/\|Saco1\|/g,","),t=t.replace(/\|Saco2\|/g,":")},t}();egret.registerClass(TextFlowMaker,"TextFlowMaker");var TextFlowElement=function(){function t(t){this.text=t}var e=(__define,t);e.prototype;return t}();egret.registerClass(TextFlowElement,"TextFlowElement",["egret.ITextElement"]);var TextFlowElementStyle=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(TextFlowElementStyle,"TextFlowElementStyle",["egret.ITextStyle"]);var BaseView=function(t){function e(){t.call(this),this.setSize()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initBlackBg=function(){this._blackBg=new egret.Shape,this._blackBg.graphics.beginFill(0,.6),this._blackBg.graphics.drawRect(0,0,Api.StageUtil.stageWidth,Api.StageUtil.stageHeight),this._blackBg.graphics.endFill(),this._blackBg.touchEnabled=!0,this._blackBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this)},n.onGuide=function(t){this.checkGuide(t.eventBody)},n.checkGuide=function(t){return this.isInited&&this.parent?void(this.interestGuide&&this.interestGuide.indexOf(t)>-1&&(this.showGuide(t),this.currentGuideID=null)):void(this.currentGuideID=t)},n.showGuide=function(t){},n.setScaleEffect=function(t){this._scaleEffect=t},n.setSize=function(){this.top=0,this.bottom=0,this.left=0,this.right=0},n.childrenCreated=function(){var t=this;this.btnClose&&(this.btnClose.touchEnabled=!0,this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this)),egret.callLater(function(){t.initView(),t.isInited=!0},this)},n.initView=function(){},n.setSkinName=function(t){this.skinName="resource/skins/"+t+".exml"},n.openView=function(t){var e=this;void 0===t&&(t=null),this.isInited||!this.resources?(this.viewParent.addChild(this),egret.callLater(function(){e.open(t)},this)):(SimpleLoading.i().showLoading(),Api.ResourceUtil.loadResource(this.resources,function(){SimpleLoading.i().hideLoading(),e.viewParent.addChild(e),egret.callLater(function(){e.open(t)},e)},this.onResLoadProgress,this))},n.onResLoadProgress=function(t,e){SimpleLoading.i().setProgress(t/e)},n.open=function(t){if(void 0===t&&(t=null),this._scaleEffect||this.currentGuideID&&this.checkGuide(this.currentGuideID),this.closeHookView){if("all"==this.closeHookView)Api.ViewManager.closeAll();else if(this.closeHookView instanceof e)this.closeHookView.close();else for(var i=0;i=this.closeHookView.length;i++)Api.ViewManager.closeView(this.closeHookView[i]);this.closeHookView=null}this._needBg&&this.viewParent.addChild(this._blackBg),this.viewParent.addChild(this),egret.Tween.removeTweens(this),this.measure(),this.visible=!1,egret.callLater(this.calculatePos,this)},n.calculatePos=function(){var t=this;if(this.width>Api.StageUtil.stageWidth||this.height>Api.StageUtil.stageHeight){var e=Api.StageUtil.stageHeight/this.height;this.scaleX=this.scaleY=e}else this.scaleX=this.scaleY=1;var i=(Api.StageUtil.stageWidth-this.width*this.scaleX)/2,n=(Api.StageUtil.stageHeight-this.height*this.scaleY)/2+3;if(this._scaleEffect){this.touchEnabled=!1,this.touchChildren=!1,this.alpha=.3;var s=this.scaleX,r=.8*s;this.scaleX=this.scaleY=r,this.x=i+this.width*(1-r)/2,this.y=n+this.height*(1-r)/2,egret.Tween.get(this).to({x:i,y:n,alpha:1,scaleX:s,scaleY:s},300,egret.Ease.backOut).call(function(){t.touchEnabled=!0,t.touchChildren=!0,t.currentGuideID&&t.checkGuide(t.currentGuideID)},this)}else this.x=i,this.y=n;this.visible=!0},n.close=function(){var t=this;if(this._scaleEffect){var e=this.x,i=this.y;this.touchEnabled=!1,this.touchChildren=!1;var n=this.scaleX,s=.8*n;egret.Tween.removeTweens(this),egret.Tween.get(this).to({x:e+this.width*(1-s)/2,y:i+this.height*(1-s)/2,alpha:.3,scaleX:s,scaleY:s},300,egret.Ease.backIn).call(function(){t.touchEnabled=!0,t.touchChildren=!0,t.scaleX=n,t.scaleY=n,t.parent&&t.parent.removeChild(t)},this)}else this.parent&&this.parent.removeChild(this);this._blackBg&&this._blackBg.parent&&this._blackBg.parent.removeChild(this._blackBg)},n.setRes=function(t){this.resources=t},n.regMsgListener=function(t,e){Api.MessageCenter.regMsgListener(t,e,this)},n.removeMsgListener=function(t,e){Api.MessageCenter.removeMsgListener(t,e,this)},n.sendMsg=function(t){Api.GameSocket.sendMsg(t)},n.getGlobalText=function(t){return Api.GlobalRes.getText(t)},n.setGlobalText=function(t,e){t.text=this.getGlobalText(e)},e}(eui.Component);egret.registerClass(BaseView,"BaseView");var ViewManager=function(){function t(){this._views=Object.create(null)}var e=(__define,t),i=e.prototype;return i.initMask=function(){this.backBlack=new eui.Rect(Api.StageUtil.stageWidth,Api.StageUtil.stageHeight,0),this.backBlack.alpha=.6,this.backBlack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this)},i.regView=function(t,e,i){this._views[t]=new e,this._views[t].viewID=t,this._views[t].viewParent=Api.Layers.getLayer(i)},i.openView=function(t,e){if(void 0===e&&(e=null),this._views[t]){var i=this._views[t];i.openView(e)}},i.openViewAndClose=function(t,e,i){if(this._views[t]){var n=this._views[t];n.closeHookView=e,n.openView(i)}},i.getView=function(t){return this._views[t]},i.closeView=function(t){this._views[t]&&this._views[t].close()},i.closeViewsByLayer=function(t){for(var e=Api.Layers.getLayer(t);e.numChildren>0;){var i=e.getChildAt(0);i.close()}},i.close=function(t){t.close()},i.closeAll=function(t){var e=Api.Layers.getLayers();for(var i in e)for(var n=e[i].numChildren-1;n>=0;){var s=e[i].getChildAt(n);n--,s!=t&&(s instanceof BaseView?s.close():s.parent.removeChild(s))}},t}();egret.registerClass(ViewManager,"ViewManager");var GameControl=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(GameControl,"GameControl");var GameData=function(){function t(){}var e=(__define,t);e.prototype;return t.config=[{drag_img:"image_06_png",accept_img:"3_png",text:"mother"},{drag_img:"image_12_png",accept_img:"2_png",text:"father"},{drag_img:"image_14_png",accept_img:"1_png",text:"brother"},{drag_img:"image_16_png",accept_img:"4_png",text:"sister"},{drag_img:"image_22_png",accept_img:"6_png",text:"grandmother"},{drag_img:"image_24_png",accept_img:"5_png",text:"grandfather"}],t.score=0,t}();egret.registerClass(GameData,"GameData");var GameDragAcceptItem=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(t){this.proto=GameData.config[t],this.img.source=this.proto.accept_img,this.txtName.text=""},n.childrenCreated=function(){t.prototype.childrenCreated.call(this),Api.DragManager.regAcceptDrag(this)},n.onDragIn=function(t){this.txtName.text=t.proto.text,t.visible=!1},n.check=function(){return this.txtName.text==this.proto.text?!0:(this.txtName.textColor=16711680,!1)},n.reset=function(){this.txtName.text="",this.txtName.textColor=3355443},e}(eui.Component);egret.registerClass(GameDragAcceptItem,"GameDragAcceptItem",["DragAccept"]);
var GameDragItem=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(t){this.proto=GameData.config[t],this.img.source=this.proto.drag_img},n.childrenCreated=function(){t.prototype.childrenCreated.call(this),Api.DragManager.regDragItem(this)},n.onDragBegin=function(t){this.dispatchEventWith(e.DRAG_BEGIN)},n.onDragEnd=function(t){this.dispatchEventWith(e.DRAG_END)},n.onDragMove=function(t){},n.reset=function(){this.visible=!0},e.DRAG_BEGIN="drag_begin",e.DRAG_END="drag_end",e.DRAG_MOVE="drag_move",e}(eui.Component);egret.registerClass(GameDragItem,"GameDragItem",["DragItem"]);var GameView=function(t){function e(){t.call(this),this.skinName=new GameSkin}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initView=function(){var e=this;t.prototype.initView.call(this),this.forEachDragItem(function(t,e){t.init(e)}),this.forEachDragAccept(function(t,e){t.init(e)}),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){"check_png"==e.btn.source?(e.check(),Api.ViewManager.openView(4,GameData.score),e.btn.source="submit_png"):Api.ViewManager.openView(3,GameData.score)},this)},n.check=function(){GameData.score=0,this.forEachDragAccept(function(t){t.check()&&(GameData.score+=1)}),this.tf_total.text=GameData.score.toString()},n.reset=function(){GameData.score=0,this.tf_total.text="0",this.btn.source="check_png",this.forEachDragItem(function(t){t.reset()}),this.forEachDragAccept(function(t){t.reset()})},n.forEachDragItem=function(t){this.forEachItem("drag",t)},n.forEachDragAccept=function(t){this.forEachItem("drag_ac",t)},n.forEachItem=function(t,e){for(var i=0;6>i;i++)e(this[t+"_"+i],i)},e}(BaseView);egret.registerClass(GameView,"GameView");var GameOverView=function(t){function e(){t.call(this),this.skinName=new GameOverSkin}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initView=function(){this.btn_restart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this)},n.open=function(e){t.prototype.open.call(this),this.tf_total.text=e,2>=e?this.tf_evalue.text="Try Again":4>=e?(this.tf_evalue.text="Very Good!",egret.setTimeout(function(){RES.getRes("good_mp3").play(0,1)},this,500)):(this.tf_evalue.text="Excellent!",egret.setTimeout(function(){RES.getRes("verygood_mp3").play(0,1)},this,500)),this.tf_score.text="总分数："+e+"分"},n.onRestart=function(){this.close()},n.close=function(){t.prototype.close.call(this),Api.ViewManager.getView(2).reset()},e}(BaseView);egret.registerClass(GameOverView,"GameOverView");var GameStartView=function(t){function e(){t.call(this),this.skinName=new GameStartSkin}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initView=function(){this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStart,this)},n.onStart=function(){this.close()},n.close=function(){t.prototype.close.call(this),Api.ViewManager.openView(2)},e}(BaseView);egret.registerClass(GameStartView,"GameStartView");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=960,this.textField.height=100,this.textField.textAlign="center"},n.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createChildren=function(){t.prototype.createChildren.call(this);var e=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",e),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},n.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},n.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},n.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},n.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},n.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},n.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},n.startCreateScene=function(){Api.Init(this.stage),Api.ViewManager.regView(1,GameStartView,LayerType.GAME),Api.ViewManager.regView(2,GameView,LayerType.GAME),Api.ViewManager.regView(3,GameOverView,LayerType.GAME),Api.ViewManager.regView(4,Score,LayerType.TIPS),Api.ViewManager.openView(1)},e}(eui.UILayer);egret.registerClass(Main,"Main");var Score=function(t){function e(){t.call(this),this.skinName=new ScoreSkin,this.width=195,this.height=95,this.touchEnabled=!1,this.touchChildren=!1}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setSize=function(){},n.initView=function(){},n.open=function(e){var i=this;t.prototype.open.call(this),this.tf_score.text=e,egret.callLater(function(){var t=i.y-100;egret.Tween.get(i).to({y:t},1e3).call(i.close,i)},this)},e}(BaseView);egret.registerClass(Score,"Score");var ThemeAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getTheme=function(t,e,i,n){function s(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);